<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1113333333</title>
    
    <!-- 微信分享配置 Meta 标签 -->
    <meta property="og:title" content="1113333333" />
    <meta property="og:description" content="222222222222222222222222222222" />
    <meta property="og:image" content="https://bt.iosv2.top/images/share-image.jpg" />
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    
    <!-- 微信专用标签 -->
    <meta name="title" content="1113333333" />
    <meta name="description" content="222222222222222222222222222222" />
    
    <!-- 更多描述标签确保微信能读取 -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="1113333333" />
    <meta name="twitter:description" content="222222222222222222222222222222" />
    <meta name="twitter:image" content="https://bt.iosv2.top/images/share-image.jpg" />
    <meta property="description" content="222222222222222222222222222222" />
    <meta name="summary" content="222222222222222222222222222222" />
    
    <script>
      // 立即设置分享链接为防红链接
      (function() {
        // 构建当前防红链接URL
        const currentUrl = window.location.href;
        
        // 立即更新 og:url 为当前防红页面URL
        const ogUrl = document.querySelector('meta[property="og:url"]');
        if (ogUrl) ogUrl.content = currentUrl;
      })();
      
      document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const targetUrl = urlParams.get('target') || urlParams.get('url');
        
        // 动态获取并设置分享信息
        if (targetUrl) {
          // 如果是主页面，尝试从API获取配置
          if (targetUrl.includes('bt.iosv2.top') && !targetUrl.includes('test-share.html')) {
            fetch('https://bt.iosv2.top/api/admin/config')
              .then(response => response.json())
              .then(data => {
                if (data.success) {
                  const config = data.data;
                  
                  // 更新页面信息
                  if (config.share_title && config.share_title.value) {
                    document.title = config.share_title.value;
                    const ogTitle = document.querySelector('meta[property="og:title"]');
                    if (ogTitle) ogTitle.content = config.share_title.value;
                  }
                  
                  if (config.share_desc && config.share_desc.value) {
                    const ogDesc = document.querySelector('meta[property="og:description"]');
                    if (ogDesc) ogDesc.content = config.share_desc.value;
                  }
                  
                  if (config.share_image_url && config.share_image_url.value) {
                    const ogImage = document.querySelector('meta[property="og:image"]');
                    if (ogImage) {
                      const imageUrl = config.share_image_url.value.startsWith('http') 
                        ? config.share_image_url.value 
                        : 'https://bt.iosv2.top' + config.share_image_url.value;
                      ogImage.content = imageUrl;
                    }
                  }
                }
              })
              .catch(error => {
                console.log('获取配置失败:', error);
              });
          }
          
          // 给微信足够时间读取meta标签
          setTimeout(function() {
            window.location.replace(targetUrl);
          }, 1500);
        }
        
        console.log('防红页面信息:');
        console.log('当前URL:', window.location.href);
        console.log('标题:', document.title);
        console.log('OG标题:', document.querySelector('meta[property="og:title"]')?.content);
        console.log('OG描述:', document.querySelector('meta[property="og:description"]')?.content);
        console.log('OG链接:', document.querySelector('meta[property="og:url"]')?.content);
        console.log('目标URL:', targetUrl);
      });
    </script>
    
    <style>
      * {
        box-sizing: border-box;
      }
      
      html, body {
        margin: 0;
        padding: 0;
        background: white;
        height: 100%;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <!-- 静默跳转页面 -->
  </body>
</html>
